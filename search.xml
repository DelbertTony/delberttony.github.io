<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>RHOSP13实验手册</title>
    <url>/2022/06/05/RHOSP13%E5%AE%9E%E9%AA%8C%E6%89%8B%E5%86%8C/</url>
    <content><![CDATA[<h1>RHOSP13实验手册</h1>
<h2 id="第一章-红帽Openstack平台架构">第一章 红帽Openstack平台架构</h2>
<h3 id="第一节-介绍">第一节 介绍</h3>
<img src="/2022/06/05/RHOSP13%E5%AE%9E%E9%AA%8C%E6%89%8B%E5%86%8C/image-20220606112025776.png" class title="实验环境">
<span id="more"></span>
<ul>
<li>课程中使用power节点模拟虚拟机电源管理。</li>
<li>power节点中CLI接口，创建虚拟主板管理控制器（BMC），通过hypervisor来使用IPMI协议管理每个RHOSP虚拟机，以模拟裸机管理方式。</li>
<li>每台虚拟机都需要一个虚拟BMC，各自在 623 端口上监听power 节点的 BMC 配置，如下所示：</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@power ~<span class="token punctuation">]</span><span class="token comment"># netstat -tulnp | grep 623</span>
udp        <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">172.25</span>.249.112:623      <span class="token number">0.0</span>.0.0:*                           <span class="token number">1259</span>/python         
udp        <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">172.25</span>.249.106:623      <span class="token number">0.0</span>.0.0:*                           <span class="token number">1246</span>/python         
udp        <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">172.25</span>.249.103:623      <span class="token number">0.0</span>.0.0:*                           <span class="token number">1233</span>/python         
udp        <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">172.25</span>.249.102:623      <span class="token number">0.0</span>.0.0:*                           <span class="token number">1220</span>/python         
udp        <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">172.25</span>.249.101:623      <span class="token number">0.0</span>.0.0:*                           <span class="token number">1204</span>/python  
<span class="token punctuation">[</span>root@power ~<span class="token punctuation">]</span><span class="token comment"># cat /etc/bmc/vms</span>
<span class="token comment"># List the VMs that the fake ipmi will manage. Include in the list one</span>
<span class="token comment"># VM name per line along with the proxy IP the IPMI client (ipmitool)</span>
<span class="token comment"># will use to manage it.</span>
<span class="token comment">#</span>
<span class="token comment"># EXAMPLE: VM_NAME,IP_ADDRESS</span>
controller0,172.25.249.101
compute0,172.25.249.102
ceph0,172.25.249.103
computehci0,172.25.249.106
compute1,172.25.249.112
<span class="token comment">#远程控制开关机</span>
<span class="token punctuation">(</span>undercloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ ipmitool -I lanplus -U admin -P password -H <span class="token number">172.25</span>.249.112 power on<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>查看undercloud的部署镜像</strong></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>undercloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack image list
+--------------------------------------+------------------------+--------+
<span class="token operator">|</span> ID                                   <span class="token operator">|</span> Name                   <span class="token operator">|</span> Status <span class="token operator">|</span>
+--------------------------------------+------------------------+--------+
<span class="token operator">|</span> fab32297-d1e2-4598-9e4e-6b02c8982c6f <span class="token operator">|</span> bm-deploy-kernel       <span class="token operator">|</span> active <span class="token operator">|</span>
<span class="token operator">|</span> bc8408a7-3074-4c56-8992-a56637f561e0 <span class="token operator">|</span> bm-deploy-ramdisk      <span class="token operator">|</span> active <span class="token operator">|</span>
<span class="token operator">|</span> ff82c9a3-eead-489f-a862-ca7b2b245a60 <span class="token operator">|</span> overcloud-full         <span class="token operator">|</span> active <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">86901767</span>-c252-4711-867e-a06eb52b4bfc <span class="token operator">|</span> overcloud-full-initrd  <span class="token operator">|</span> active <span class="token operator">|</span>
<span class="token operator">|</span> 4b823922-4757-468f-aad4-1e7bf0f585fa <span class="token operator">|</span> overcloud-full-vmlinuz <span class="token operator">|</span> active <span class="token operator">|</span>
+--------------------------------------+------------------------+--------+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>bm-deploy-kernel和bm-deploy-ramdisk 是用来引导操作系统启动的镜像，overcloud中的服务器 第一次启动就会使用这两个镜像，做服务器体检，获得服务器的信息，交给ironic服务的数据库，然后将服务器关机。</li>
<li>系统第二次启动会使用overcloud-full-initrd 和overcloud-full-vmlinuz，将服务器再次启动。</li>
<li>服务器启动后，在硬盘上注入overcloud-full这个镜像，然后根据ks脚本将服务器部署成为是控制节点还是计算节点。overcloud-full镜像不仅包含了系统，还包含了ceph和openstack所有的软件包，根据heat编排，将各节点部署成为各个角色。</li>
</ul>
<h3 id="第二节-OpenStack-服务组件通信故障排除方法">第二节 OpenStack 服务组件通信故障排除方法</h3>
<ol>
<li>通过查看 Keystone 日志文件定位故障：/var/log/contaners/keystone/keystone.log</li>
<li>通过查看 RabbitMQ 消息代理定位故障（oslo）</li>
<li>通过查看各服务的 API 日志信息定位故障：/var/log/containers//api.log</li>
<li>通过查看各服务组件的日志信息定位故障</li>
</ol>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">openstack catalog service_name --debug
<span class="token comment">#举例：</span>
openstack catalog nova --debug
openstack catalog show nova --debug<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="第二章-描述openstack控制平面">第二章 描述openstack控制平面</h2>
<h3 id="第一节-RabbitMQ消息队列">第一节 RabbitMQ消息队列</h3>
<p>rabbitmqctl 命令：因为 OpenStack 已经容器化运行，所有的RabbitMQ命令必须在容器内部运行典型rabbitmqctl 命令使用如下：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">rabbitmqctl report：查看 RabbitMQ 守护进程的当前状态，包括 Exchange 与 Queue 的类型
及数量
rabbitmqctl list_users：列出 RabbitMQ 用户
rabbitmqctl list_user_permissions guest 列出guest用户的权限
rabbitmqctl list_exchanges：列出 RabbitMQ 守护进程的默认配置的 Exchange
rabbitmqctl list_queues：列出可用的队列及其属性
rabbitmqctl list_consumers：列出所有的消费者及它们订阅的队列<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>追踪RabbitMQ消息，跟踪会增加系统负载，因此请确保在调查完成后禁⽤跟踪：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">rabbitmqctl trace_on：启用追踪
rabbitmqctl trace_off：禁用追踪<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>查看容器中rabbitmq的相关信息</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># docker ps | grep rabbit</span>
<span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># docker container exec rabbitmq-bundle-docker-0 rabbitmqctl report</span>
<span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># docker container exec rabbitmq-bundle-docker-0 rabbitmqctl list_users</span>
<span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># docker container exec rabbitmq-bundle-docker-0 rabbitmqctl list_exchanges</span>
<span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># docker container exec rabbitmq-bundle-docker-0 rabbitmqctl list_queues</span>
<span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># docker container exec rabbitmq-bundle-docker-0 rabbitmqctl list_consumers</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="练习：开启容器中RabbitMQ的追踪服务">练习：开启容器中RabbitMQ的追踪服务</h4>
<p>准备工作</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>student@workstation ~<span class="token punctuation">]</span>$ lab controlplane-message setup<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># docker exec -t rabbitmq-bundle-docker-0 rabbitmqctl --help</span>
<span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># docker exec -t rabbitmq-bundle-docker-0 rabbitmqctl --help | grep add</span>
<span class="token comment">#创建用户并赋权</span>
<span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># docker exec -t rabbitmq-bundle-docker-0 rabbitmqctl add_user user1 redhat</span>
<span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># docker exec -t rabbitmq-bundle-docker-0 rabbitmqctl set_permissions user1 ".*" ".*" ".*"</span>
<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span>root@controller0 /<span class="token punctuation">]</span><span class="token comment"># rabbitmqctl set_user_tags user1 administrator</span>
<span class="token comment">#开启追踪功能</span>
<span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># docker exec -t rabbitmq-bundle-docker-0 rabbitmqctl trace_on</span>
<span class="token comment">#查看rabbitmq服务监听在5672端口</span>
<span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># ss -tulnp | grep :5672</span>
<span class="token comment">#测试追踪服务</span>
<span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># ./rmq_trace.py -u user1 -p redhat -t 172.24.1.1 > /tmp/rabbit.user</span>
<span class="token punctuation">[</span>student@workstation ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">source</span> developer1-finance-rc
<span class="token punctuation">[</span>student@workstation ~<span class="token punctuation">(</span>developer1-finance<span class="token punctuation">)</span><span class="token punctuation">]</span>$ openstack server create --image rhel7 --flavor default --security-group default --key-name example-keypair --nic net-id<span class="token operator">=</span>finance-network1 finance-server2 --wait
<span class="token comment">#关闭追踪功能</span>
<span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># docker exec -t rabbitmq-bundle-docker-0 rabbitmqctl trace_off</span>
<span class="token comment">#清空环境</span>
<span class="token punctuation">[</span>student@workstation ~<span class="token punctuation">]</span>$ lab controlplane-message cleanup
<span class="token comment">#说明：</span>
设置用户对何种资源具有配置、写、读的权限通过正则表达式来匹配，这里的资源指的是virtual hosts中的exchanges、queues等，操作包括对资源进行配置、写、读。配置权限可创建、删除、资源并修改资源的行为，写权限可向资源发送消息，读权限从资源获取消息。
如<span class="token string">'^(amq\.gen.*|amq\.default)$'</span>可以匹配server生成的和默认的exchange，<span class="token string">'^$'</span>不匹配任何资源。
set_permissions <span class="token punctuation">[</span>-p <span class="token operator">&lt;</span>vhostpath<span class="token operator">></span><span class="token punctuation">]</span> <span class="token operator">&lt;</span>user<span class="token operator">></span> <span class="token operator">&lt;</span>conf<span class="token operator">></span> <span class="token operator">&lt;</span>write<span class="token operator">></span> <span class="token operator">&lt;</span>read<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="第二节-控制节点的服务">第二节 控制节点的服务</h3>
<p>初始化环境</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>student@workstation ~<span class="token punctuation">]</span>$ lab controlplane-services setup<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="练习：访问mysql数据库服务">练习：访问mysql数据库服务</h4>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># docker ps | grep galera</span>
a193b9433e43        <span class="token number">172.25</span>.249.200:8787/rhosp13/openstack-mariadb:pcmklatest               <span class="token string">"/bin/bash /usr/lo..."</span>   <span class="token number">12</span> minutes ago      Up <span class="token number">12</span> minutes                                       galera-bundle-docker-0
<span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># docker exec -t galera-bundle-docker-0 mysql -u root -e "show databases"</span>
<span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it galera-bundle-docker-0 /bin/bash</span>
<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span>root@controller0 /<span class="token punctuation">]</span><span class="token comment"># mysql -u root</span>
MariaDB <span class="token punctuation">[</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">></span> use keystone<span class="token punctuation">;</span>
MariaDB <span class="token punctuation">[</span>keystone<span class="token punctuation">]</span><span class="token operator">></span> show tables<span class="token punctuation">;</span>
MariaDB <span class="token punctuation">[</span>keystone<span class="token punctuation">]</span><span class="token operator">></span> <span class="token keyword">select</span> * from role<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>查找mysql数据库密码</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># cd /var/lib/config-data/puppet-generated/mysql/root/</span>
<span class="token punctuation">[</span>root@controller0 root<span class="token punctuation">]</span><span class="token comment"># ls -a</span>
<span class="token builtin class-name">.</span>  <span class="token punctuation">..</span>  .my.cnf
<span class="token punctuation">[</span>root@controller0 root<span class="token punctuation">]</span><span class="token comment"># vim .my.cnf</span>
<span class="token punctuation">[</span>root@controller0 root<span class="token punctuation">]</span><span class="token comment"># cat .my.cnf</span>
<span class="token punctuation">[</span>client<span class="token punctuation">]</span>
<span class="token assign-left variable">user</span><span class="token operator">=</span>root
<span class="token assign-left variable">password</span><span class="token operator">=</span><span class="token string">"dgMgg8QfNM"</span>

<span class="token punctuation">[</span>mysql<span class="token punctuation">]</span>
<span class="token assign-left variable">user</span><span class="token operator">=</span>root
<span class="token assign-left variable">password</span><span class="token operator">=</span><span class="token string">"dgMgg8QfNM"</span>
<span class="token punctuation">[</span>root@controller0 root<span class="token punctuation">]</span><span class="token comment"># ss -tnlp | grep 3306</span>
LISTEN     <span class="token number">0</span>      <span class="token number">128</span>    <span class="token number">172.24</span>.1.1:3306                     *:*                   users:<span class="token variable"><span class="token punctuation">((</span>"mysqld"<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">15486</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">))</span></span>
LISTEN     <span class="token number">0</span>      <span class="token number">128</span>    <span class="token number">172.24</span>.1.50:3306                     *:*                   users:<span class="token variable"><span class="token punctuation">((</span>"haproxy"<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">14658</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">26</span><span class="token punctuation">))</span></span>
<span class="token comment">#用password="dgMgg8QfNM"登录数据库</span>
<span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># mysql -uroot -pdgMgg8QfNM -h172.24.1.1</span>
MariaDB <span class="token punctuation">[</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">></span> show databases<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="练习：查询redis数据库的密码并登录">练习：查询redis数据库的密码并登录</h4>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#查看容器的信息</span>
<span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># docker inspect redis-bundle-docker-0</span>
<span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># grep -i pass /var/lib/config-data/puppet-generated/redis/etc/redis.conf</span>
或者
<span class="token punctuation">[</span>root@controller0 root<span class="token punctuation">]</span><span class="token comment"># netstat -tulnp | grep redis</span>
tcp        <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">172.24</span>.1.1:6379         <span class="token number">0.0</span>.0.0:*               LISTEN      <span class="token number">16412</span>/redis-server  
<span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># redis-cli -h 172.24.1.1</span>
<span class="token number">172.24</span>.1.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> AUTH wuTuATnYuMrzJQGj8KxBb6ZAW
OK
<span class="token number">172.24</span>.1.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> KEYS *
 <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"_tooz_beats:b05174d4-374f-4aaf-9e73-8f6157782b60"</span>
 <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"_tooz_beats:273ca97b-a442-49e1-bead-f31b5666df42"</span>
 <span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"_tooz_beats:controller0.0.f6f98884-e9a9-457b-80dc-c46626c8d991"</span>
 <span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"_tooz_group:alarm_evaluator"</span>
 <span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">"_tooz_beats:controller0.0.861c98f2-96fc-4afe-8e89-f1317c9d04f7"</span>
 <span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">"_tooz_group:compute-computehci0.overcloud.example.com"</span>
 <span class="token number">7</span><span class="token punctuation">)</span> <span class="token string">"_tooz_beats:controller0.0.177a2c8d-6cc4-4bb9-ba0f-8b6d5e9ca3dc"</span>
 <span class="token number">8</span><span class="token punctuation">)</span> <span class="token string">"_tooz_beats:4b27447e-a926-4361-912d-1e4fd7765e00"</span>
 <span class="token number">9</span><span class="token punctuation">)</span> <span class="token string">"_tooz_beats:2f21f9f6-8954-4340-8b93-cf58b9c5015d"</span>
<span class="token number">10</span><span class="token punctuation">)</span> <span class="token string">"_tooz_beats:c0a3ae04-a617-4a0f-8c61-181f3cfb2551"</span>
<span class="token number">11</span><span class="token punctuation">)</span> <span class="token string">"_tooz_group:compute-compute0.overcloud.example.com"</span>
<span class="token number">12</span><span class="token punctuation">)</span> <span class="token string">"_tooz_beats:525147c1-767c-43f4-9adf-a3da092fe497"</span>
<span class="token number">13</span><span class="token punctuation">)</span> <span class="token string">"_tooz_beats:2a1a6744-4217-4db6-91f1-ca03780e5655"</span>
<span class="token number">14</span><span class="token punctuation">)</span> <span class="token string">"_tooz_beats:8f983ebd-1639-4126-b4cc-183efb7ee03b"</span>
<span class="token number">15</span><span class="token punctuation">)</span> <span class="token string">"_tooz_groups"</span>
<span class="token number">16</span><span class="token punctuation">)</span> <span class="token string">"_tooz_group:compute-compute1.overcloud.example.com"</span>
<span class="token number">17</span><span class="token punctuation">)</span> <span class="token string">"gnocchi-config"</span>
<span class="token number">18</span><span class="token punctuation">)</span> <span class="token string">"_tooz_group:central-global"</span>
<span class="token number">19</span><span class="token punctuation">)</span> <span class="token string">"_tooz_group:gnocchi-processing"</span>
<span class="token number">20</span><span class="token punctuation">)</span> <span class="token string">"_tooz_beats:4d102120-2c84-4b9a-b263-7da6c243c621"</span>
<span class="token number">21</span><span class="token punctuation">)</span> <span class="token string">"_tooz_beats:eb8bc300-5348-4c11-aa3f-b8a7c7304ac9"</span>
<span class="token number">22</span><span class="token punctuation">)</span> <span class="token string">"_tooz_beats:controller0.0.175fc0dd-4598-46f5-9e88-cf7cf75f2364"</span>
<span class="token number">172.24</span>.1.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token builtin class-name">type</span> gnocchi-config
<span class="token builtin class-name">hash</span>
<span class="token number">172.24</span>.1.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token builtin class-name">type</span> _tooz_beats:b05174d4-374f-4aaf-9e73-8f6157782b60
string<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>查看集群</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># pcs resource show</span>
<span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># pcs resource disable openstack-manila-share</span>
<span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># pcs resource enable openstack-manila-share</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h4 id="练习：查看vnc登录的地址">练习：查看vnc登录的地址</h4>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>student@workstation ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">source</span> developer1-finance-rc
<span class="token punctuation">[</span>student@workstation ~<span class="token punctuation">(</span>developer1-finance<span class="token punctuation">)</span><span class="token punctuation">]</span>$ openstack console url show finance-server3
+-------+------------------------------------------------------------------------------------+
<span class="token operator">|</span> Field <span class="token operator">|</span> Value                                                                              <span class="token operator">|</span>
+-------+------------------------------------------------------------------------------------+
<span class="token operator">|</span> <span class="token builtin class-name">type</span>  <span class="token operator">|</span> novnc                                                                              <span class="token operator">|</span>
<span class="token operator">|</span> url   <span class="token operator">|</span> http://172.25.250.50:6080/vnc_auto.html?token<span class="token operator">=</span>3f09227e-d49d-41b2-98ed-d61eda6296e5 <span class="token operator">|</span>
+-------+------------------------------------------------------------------------------------+
<span class="token comment">#在控制节点上看监听端口</span>
<span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># netstat -tulnp | grep 6080</span>
<span class="token punctuation">[</span>root@foundation0 ~<span class="token punctuation">]</span><span class="token comment"># firefox http://172.25.250.50:6080/vnc_auto.html?token=3f09227e-d49d-41b2-98ed-d61eda6296e5</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<img src="/2022/06/05/RHOSP13%E5%AE%9E%E9%AA%8C%E6%89%8B%E5%86%8C/image-20220607212134160.png" class title="vnc">
<p>清空环境</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>student@workstation ~<span class="token punctuation">]</span>$ lab controlplane-services cleanup<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="第三章-身份认证管理">第三章 身份认证管理</h2>
<h3 id="第一节-管理集成的-IdM-后端配置">第一节 管理集成的 IdM 后端配置</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#管理员身份查看用户和域信息</span>
<span class="token punctuation">(</span>undercloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">source</span> overcloudrc
<span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack domain list
<span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack user list --domain Example
<span class="token comment">#查看用户在当前域的token信息</span>
<span class="token punctuation">[</span>student@workstation ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">source</span> developer1-finance-rc
<span class="token punctuation">[</span>student@workstation ~<span class="token punctuation">(</span>developer1-finance<span class="token punctuation">)</span><span class="token punctuation">]</span>$ openstack token issue<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="练习：配置dashboard可以登录其他域的用户">练习：配置dashboard可以登录其他域的用户</h4>
<ol>
<li>配置Horizon控制面板</li>
</ol>
<ul>
<li>
<p>默认情况下，身份认证服务使用default域</p>
</li>
<li>
<p>集成外部认证后端时需要单独创建后端的认证域</p>
</li>
<li>
<p>集成IdM认证后端时，需要在控制节点Horizon控制面板中启用multidomain支持特性</p>
<p>如下所示：</p>
</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># vim /var/lib/config-data/puppetgenerated/horizon/etc/openstack-dashboard/local_settings</span>
OPENSTACK_KEYSTONE_MULTIDOMAIN_SUPPORT <span class="token operator">=</span> True
<span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># docker restart horizon</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<ol start="2">
<li>配置身份认证服务：</li>
</ol>
<ul>
<li>编辑Keystone配置文件使dashboard控制面板支持multidomain特性</li>
</ul>
<p>​		如下所示：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># vim /var/lib/configdata/puppetgenerated/keystone/etc/keystone/keystone.conf</span>
<span class="token punctuation">[</span>identity<span class="token punctuation">]</span>
domain_specific_drivers_enabled <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># docker restart keystone</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="第二节-管理身份服务令牌">第二节 管理身份服务令牌</h3>
<h4 id="练习：轮转key">练习：轮转key</h4>
<p>参考文档链接：<a href="http://content.example.com/rhosp13.0/x86_64/dvd/docs/html/">http://content.example.com/rhosp13.0/x86_64/dvd/docs/html/</a></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#查看轮转前</span>
<span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># ls /var/lib/config-data/puppet-generated/keystone/etc/keystone/fernet-keys/</span>
<span class="token number">0</span>  <span class="token number">1</span>
<span class="token comment">#轮转可以</span>
<span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">source</span> ~/stackrc
<span class="token punctuation">(</span>undercloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack workflow execution create tripleo.fernet_keys.v1.rotate_fernet_keys <span class="token string">'&#123;"container": "overcloud"&#125;'</span>
<span class="token punctuation">(</span>undercloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack workflow execution show 7cea4168-d91f-456c-8d9c-2d9bb1200260
<span class="token comment">#查看轮转后</span>
<span class="token punctuation">[</span>root@controller0 ~<span class="token punctuation">]</span><span class="token comment"># ls /var/lib/config-data/puppet-generated/keystone/etc/keystone/fernet-keys/</span>
<span class="token number">0</span>  <span class="token number">1</span>  <span class="token number">2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="第三节-管理项目组织">第三节 管理项目组织</h3>
<p><strong>域 Domain：</strong></p>
<ul>
<li>Keystone v3（Identity Service v3）的新特性</li>
<li>域包含用户、组与项目</li>
<li>RHOSP 初始安装了 Default 域</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ openstack domain create <span class="token operator">&lt;</span>domain<span class="token operator">></span>：创建额外的域
$ openstack domain list：列出已有的域<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><strong>用户 User：</strong></p>
<ul>
<li>管理员应该保留 Default 域用于服务账户的使用</li>
<li>管理员可以创建新的域，并加入用户</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ openstack user create <span class="token operator">&lt;</span>user<span class="token operator">></span> --domain <span class="token operator">&lt;</span>domain<span class="token operator">></span> --password-prompt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>​	说明：指定域添加新的用户，不指定 --domain 选项时，默认为 Default domain；不建议命令行中指定密码，存在安全风险，建议交互式输入密码。</p>
<p><strong>组 Group：</strong></p>
<ul>
<li>Keystone v3 还引入了组的概念</li>
<li>组有利于批量管理用户访问资源</li>
<li>管理员可以对组执行单一操作，并将其作用分发给组中的所有成员</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ openstack group create <span class="token operator">&lt;</span>group<span class="token operator">></span> --domain <span class="token operator">&lt;</span>domain<span class="token operator">></span> <span class="token comment">#指定域创建组</span>
$ openstack group <span class="token function">add</span> user --group-domain <span class="token operator">&lt;</span>group_domain<span class="token operator">></span> --user-domain <span class="token operator">&lt;</span>user_domain<span class="token operator">></span> <span class="token operator">&lt;</span>group<span class="token operator">></span> <span class="token operator">&lt;</span>user<span class="token operator">></span> <span class="token comment">#将域中的用户添加到域中的组中</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><strong>项目 Project：</strong></p>
<ul>
<li>Keystone v3 引入，用户不再包含于项目中，而是包含于域中，因此用户可从属于多个项目</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ openstack project create <span class="token operator">&lt;</span>project<span class="token operator">></span> --domain <span class="token operator">&lt;</span>domain<span class="token operator">></span> <span class="token comment">#指定域创建项目</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><strong>角色管理：</strong></p>
<ul>
<li>身份认证服务使用基于角色的访问控制（RBAC）来认证授权用户访问 OpenStack</li>
<li>管理员可为用户与组分配角色来授权访问域与项目</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ openstack role <span class="token function">add</span> --domain Example --user admin admin
<span class="token comment">#为 Default 域中的 admin 用户授予 Example 域的 admin 角色</span>
$ openstack role <span class="token function">add</span> --project research --project-domain Example --group developers --group-domain Lab _member_
<span class="token comment">#为 Lab 域的 developers 组授予 Example 域中 research 项⽬的_member_ 角色</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>用户存放在IDM中</strong></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@foundation0 ~<span class="token punctuation">]</span><span class="token comment"># ssh utility</span>
<span class="token punctuation">[</span>student@utility ~<span class="token punctuation">]</span>$ kinit admin
Password <span class="token keyword">for</span> admin@LAB.EXAMPLE.NET: RedHat123^
<span class="token punctuation">[</span>student@utility ~<span class="token punctuation">]</span>$ ipa user-find <span class="token operator">|</span> <span class="token function">grep</span> User
User login: admin
User login: architect1
User login: architect2
User login: architect3
……
<span class="token punctuation">[</span>student@utility ~<span class="token punctuation">]</span>$ ipa group-find <span class="token operator">|</span> <span class="token function">grep</span> Group
Group name: admins
Group name: consulting-admins
Group name: consulting-members
Group name: consulting-swiftoperators
Group name: editors
……<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="练习：配置用户并赋予角色">练习：配置用户并赋予角色</h4>
<ul>
<li>创建 OpenStack 域 210Demo，其中包含 Engineering 与 Production项目</li>
<li>在域 210Demo 中创建 OpenStack 组 Devops，其中需包含以下用户：
<ul>
<li>a. Robert 用户是 Engineering 项目的用户与管理员，email 地址为： <a href="mailto:Robert@lab.example.com">Robert@lab.example.com</a>。</li>
<li>b. George 用户是 Engineering 项目的用户，email 地址为：George@lab.example.com。</li>
<li>c. William 用户是 Production 项目的用户与管理员，email 地址为： <a href="mailto:William@lab.example.com">William@lab.example.com</a>。</li>
<li>d. John 用户是 Production 项目的用户，email 地址为：John@lab.example.com。 所有用户账户的密码都是 redhat</li>
</ul>
</li>
</ul>
<p>登录</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@foundation0 ~<span class="token punctuation">]</span><span class="token comment"># ssh stack@director</span>
<span class="token punctuation">(</span>undercloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">source</span> overcloudrc<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>创建域</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack domain create 210Demo<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>创建项目</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack project create Engineering --domain 210Demo
<span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack project create Production --domain 210Demo<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>创建组</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack group create Devops --domain 210Demo<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>创建用户</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack user create Robert --domain 210Demo --password redhat --project Engineering --project-domain 210Demo --email Robert@lab.example.com
<span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack user create George --domain 210Demo --password redhat --project Engineering --project-domain 210Demo --email George@lab.example.com
<span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack user create William --domain 210Demo --password redhat --project Production --project
-domain 210Demo --email William@lab.example.com
<span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack user create John --domain 210Demo --password redhat --project Production --project-domain 210Demo --email John@lab.example.com<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>给用户赋予角色</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack role <span class="token function">add</span> --user Robert --user-domain 210Demo --project Engineering --project-domain 210Demo admin
<span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack role <span class="token function">add</span> --user Robert --user-domain 210Demo --project Engineering --project-domain 210Demo _member_
<span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack role <span class="token function">add</span> --user George --user-domain 210Demo --project Engineering --project-domain 210Demo _member_
<span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack role <span class="token function">add</span> --user William --user-domain 210Demo --project Production --project-domain 210Demo admin
<span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack role <span class="token function">add</span> --user William --user-domain 210Demo --project Production --project-domain 210Demo _member_
<span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack role <span class="token function">add</span> --user John --user-domain 210Demo --project Production --project-domain 210Demo _member_

<span class="token comment">#验证</span>
<span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack role assignment list --user Robert --user-domain 210Demo --project Engineering --project-domain 210Demo --names
+----------+----------------+-------+---------------------+--------+-----------+
<span class="token operator">|</span> Role     <span class="token operator">|</span> User           <span class="token operator">|</span> Group <span class="token operator">|</span> Project             <span class="token operator">|</span> Domain <span class="token operator">|</span> Inherited <span class="token operator">|</span>
+----------+----------------+-------+---------------------+--------+-----------+
<span class="token operator">|</span> admin    <span class="token operator">|</span> Robert@210Demo <span class="token operator">|</span>       <span class="token operator">|</span> Engineering@210Demo <span class="token operator">|</span>        <span class="token operator">|</span> False     <span class="token operator">|</span>
<span class="token operator">|</span> _member_ <span class="token operator">|</span> Robert@210Demo <span class="token operator">|</span>       <span class="token operator">|</span> Engineering@210Demo <span class="token operator">|</span>        <span class="token operator">|</span> False     <span class="token operator">|</span>
+----------+----------------+-------+---------------------+--------+-----------+
<span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack role assignment list --user George --user-domain 210Demo --project Engineering --project-domain 210Demo --names
+----------+----------------+-------+---------------------+--------+-----------+
<span class="token operator">|</span> Role     <span class="token operator">|</span> User           <span class="token operator">|</span> Group <span class="token operator">|</span> Project             <span class="token operator">|</span> Domain <span class="token operator">|</span> Inherited <span class="token operator">|</span>
+----------+----------------+-------+---------------------+--------+-----------+
<span class="token operator">|</span> _member_ <span class="token operator">|</span> George@210Demo <span class="token operator">|</span>       <span class="token operator">|</span> Engineering@210Demo <span class="token operator">|</span>        <span class="token operator">|</span> False     <span class="token operator">|</span>
+----------+----------------+-------+---------------------+--------+-----------+
<span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack role assignment list --user William --user-domain 210Demo --project Production --project-domain 210Demo --names
+----------+-----------------+-------+--------------------+--------+-----------+
<span class="token operator">|</span> Role     <span class="token operator">|</span> User            <span class="token operator">|</span> Group <span class="token operator">|</span> Project            <span class="token operator">|</span> Domain <span class="token operator">|</span> Inherited <span class="token operator">|</span>
+----------+-----------------+-------+--------------------+--------+-----------+
<span class="token operator">|</span> admin    <span class="token operator">|</span> William@210Demo <span class="token operator">|</span>       <span class="token operator">|</span> Production@210Demo <span class="token operator">|</span>        <span class="token operator">|</span> False     <span class="token operator">|</span>
<span class="token operator">|</span> _member_ <span class="token operator">|</span> William@210Demo <span class="token operator">|</span>       <span class="token operator">|</span> Production@210Demo <span class="token operator">|</span>        <span class="token operator">|</span> False     <span class="token operator">|</span>
+----------+-----------------+-------+--------------------+--------+-----------+
<span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack role assignment list --user John --user-domain 210Demo --project Production --project-domain 210Demo --names
+----------+--------------+-------+--------------------+--------+-----------+
<span class="token operator">|</span> Role     <span class="token operator">|</span> User         <span class="token operator">|</span> Group <span class="token operator">|</span> Project            <span class="token operator">|</span> Domain <span class="token operator">|</span> Inherited <span class="token operator">|</span>
+----------+--------------+-------+--------------------+--------+-----------+
<span class="token operator">|</span> _member_ <span class="token operator">|</span> John@210Demo <span class="token operator">|</span>       <span class="token operator">|</span> Production@210Demo <span class="token operator">|</span>        <span class="token operator">|</span> False     <span class="token operator">|</span>
+----------+--------------+-------+--------------------+--------+-----------+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>添加用户到组</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack group <span class="token function">add</span> user --group-domain 210Demo --user-domain 210Demo Devops Robert
<span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack group <span class="token function">add</span> user --group-domain 210Demo --user-domain 210Demo Devops George
<span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack group <span class="token function">add</span> user --group-domain 210Demo --user-domain 210Demo Devops William
<span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack group <span class="token function">add</span> user --group-domain 210Demo --user-domain 210Demo Devops John<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>给组添加角色</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack role <span class="token function">add</span> --group Devops --group-domain 210Demo --project Engineering --project-domain 210Demo admin
<span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack role <span class="token function">add</span> --group Devops --group-domain 210Demo --project Engineering --project-domain 210Demo _member_
<span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack role <span class="token function">add</span> --group Devops --group-domain 210Demo --project Production --project-domain 210Demo admin
<span class="token punctuation">(</span>overcloud<span class="token punctuation">)</span> <span class="token punctuation">[</span>stack@director ~<span class="token punctuation">]</span>$ openstack role <span class="token function">add</span> --group Devops --group-domain 210Demo --project Production --project-domain 210Demo _member_<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>RHCA</tag>
        <tag>openstack</tag>
      </tags>
  </entry>
  <entry>
    <title>复旦CTJ</title>
    <url>/2022/03/05/%E5%A4%8D%E6%97%A6CTJ/</url>
    <content><![CDATA[<h1>记录ctj三战复旦<mark class="label ">403</mark></h1>
<h2 id="金专妥妥有书读">金专妥妥有书读</h2>
<div class="note default"><h4 id="《重生之我在上外贸》-mark-class-label-default-QAQ-恭喜ctj即将上岸（一定！）数院调剂加油！-mark">《重生之我在上外贸》  <s><mark class="label default">QAQ 恭喜ctj即将上岸（一定！）数院调剂加油！</mark></s></h4>
<span id="more"></span>
<ul>
<li>但是今年是真的卷啊！！<em><mark class="label warning">预估排名</mark></em></li>
</ul>
<!-- <img src="3.jpg" width="30%" height="30%"  style="margin: 0 auto;"/> -->
<!--![卷](6.jpg "太卷啦")-->
<img src="/2022/03/05/%E5%A4%8D%E6%97%A6CTJ/6.jpg" class title="太卷啦">
<ul>
<li>其中还不乏有内鬼搞心态=-=</li>
</ul>
<!--
<img src="1.jpg" width="30%" height="30%" style="display:inline-block;"/>
<img src="2.jpg" width="30%" height="30%" style="display:inline-block;margin-left:10px;"/>
-->
<div class="group-picture"><div class="group-picture-row"><div class="group-picture-column"><img src="/2022/03/05/%E5%A4%8D%E6%97%A6CTJ/1.jpg" class title="内鬼1！"></div><div class="group-picture-column"><img src="/2022/03/05/%E5%A4%8D%E6%97%A6CTJ/2.jpg" class title="内鬼2！"></div></div></div>
<ul>
<li>预计扩招还挺有机会的。</li>
</ul>
<!--<img src="5.jpg" width="30%" height="30%"  style="margin: 0 auto;"/>-->
<!--![扩招](5.jpg "扩招！")-->
<img src="/2022/03/05/%E5%A4%8D%E6%97%A6CTJ/5.jpg" class title="扩招">
<ul>
<li>金融确实太卷了，粥粥还要考啊？hhh</li>
</ul>
<!--<img src="4.jpg" width="30%" height="30%"  style="margin: 0 auto;"/>-->
<!--![预估分数线](4.jpg "预估分数线")-->
<img src="/2022/03/05/%E5%A4%8D%E6%97%A6CTJ/4.jpg" class title="预估分数线">
<ul>
<li>还有一周出校线啦！更新一波最新补全成绩：</li>
</ul>
<!--![补全成绩](7.jpg "补全成绩]")-->
<img src="/2022/03/05/%E5%A4%8D%E6%97%A6CTJ/7.jpg" class title="预估分数线">
<ul>
<li>国家线高得离谱啊，今年是什么，意在让大家积极就业么=-=</li>
</ul>
<!--![国家线](10.jpg "国家线]")-->
<img src="/2022/03/05/%E5%A4%8D%E6%97%A6CTJ/10.jpg" class title="国家线">
<ul>
<li>清华这应用统计数三划线140？<s><mark class="label default">山东师范也太可怜了orz</mark></s></li>
</ul>
<div class="group-picture"><div class="group-picture-row"><div class="group-picture-column"><img src="/2022/03/05/%E5%A4%8D%E6%97%A6CTJ/8.jpg" class title="清华"></div></div><div class="group-picture-row"><div class="group-picture-column"><img src="/2022/03/05/%E5%A4%8D%E6%97%A6CTJ/9.jpg" class title="山东师范"></div></div></div>
<ul>
<li>校线已出，“内部消息”三院同线：<mark class="label ">400</mark>！上岸上岸！</li>
</ul>
<!--![复旦校线](11.jpg "复旦校线")-->
<img src="/2022/03/05/%E5%A4%8D%E6%97%A6CTJ/11.jpg" class title="复旦校线">
<ul>
<li>明天qxd数院复试，加油呀尽力就好了~27进16冲！</li>
</ul>
<div class="group-picture"><div class="group-picture-row"><div class="group-picture-column"><img src="/2022/03/05/%E5%A4%8D%E6%97%A6CTJ/12.jpg" class title="调剂通知"></div><div class="group-picture-column"><img src="/2022/03/05/%E5%A4%8D%E6%97%A6CTJ/13.jpg" class title="调剂名单"></div></div></div>
<ul>
<li>最后的最后调剂至上外贸，恭喜~ 在往后的日子里继续加油吧，要相信自己。<br>
<img src="/2022/03/05/%E5%A4%8D%E6%97%A6CTJ/14.jpg" class title="上外贸录取"></li>
</ul>
</div>]]></content>
      <categories>
        <category>好友</category>
      </categories>
      <tags>
        <tag>CTJ</tag>
      </tags>
  </entry>
</search>
